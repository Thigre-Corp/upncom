{# templates/components/ProductSearch.html.twig #}
{# for the Live Component to work, there must be a single root element
(e.g. a <div>) where the attributes are applied to #}

    <div {{ attributes.defaults(stimulus_controller('appear')) }}>
        <div class="barre-recherche-wrapper frostedGlass">
            <label for="recherche">Rechercher:</label>
            <input id="recherche" type="search" data-model="debounce(1000)|query" name="recherche">
        </div>
        <div id="results--{{ this.query }}">
            {% set lastItem = 0 %}
            <div class="realisation-container">
                {% for realisation in this.realisations %}
                    <twig:RealisationComponent realisation='{{realisation}}' class="{{ cycle(['', 'alt'], loop.index) }}"
                        id="realisation--page-{{page}}-{{loop.index}}"></twig:RealisationComponent>
                    {% set lastItem = lastItem + loop.index %}
                {% endfor %}


                {# c'est l√† que la magie op√®re... pr√©voire une petite animation !
                avec le couple balise/id, il y aurait moyen de remplacer dans le DOM l'realisation "loader" une fois les
                nouvelles infos re√ßues.#}
                {% if this.hasMore %}
                {# <div id="page--{{ this.page + 1 }}"> #}
                    {# {% for i in 1..per_page %} #}
                    <div>
                        <realisation class="blog-card loading frostedGlass" id="realisation--{{ page + 1 }}-{{ lastItem }}" {# ü¶Å - The trigger #} {#
                            {% if loop.first %} #} data-appear-target="loader" data-action="appear->live#action"
                            data-live-action-param="more" {# {% endif %} #}>
                            {# üêπ - Loading bar #}
                            {# Animated progress bar shown during page load #}
                            <span>LOADING</span>
                        </realisation>
                    </div>
                    {# {% endfor %} #}
                    {#
                </div> #}
                {% endif %}
                {% if not this.hasMore %}
                <div class="blog-card nomore frostedGlass">
                    {% if not lastItem %}
                        aucun r√©sultat pour votre recherche...
                    {% endif %}
                </div>
                {% endif %}
            </div>
        </div>
    </div>