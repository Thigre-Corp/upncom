{# templates/components/ProductSearch.html.twig #}
{# for the Live Component to work, there must be a single root element
(e.g. a <div>) where the attributes are applied to #}

    <div {{ attributes.defaults(stimulus_controller('appear')) }}>

        <input type="search" data-model="debounce(1000)|query" name="recherche">

        <div id="results--{{ this.query }}">
            {# {% if page > 1 %}
            {# ü¶ä #}
            {# Adding a fake "previous page" div is enough to trick the system #}
            {# It must have the same ID than the original page #}
            {# <div class="ProductGrid_page" id="page--{{ page - 1 }}" data-live-ignore="true"></div>

            {% endif %} #}
            {% set lastItem = 0 %}

            <div class="realisation-container">
                {% for realisation in this.realisations %}
                {# <div id="page--{{ this.page }}"> #}
                    <twig:RealisationComponent realisation='{{realisation}}' class="{{ cycle(['', 'alt'], loop.index) }}"
                        id="realisation--page-{{page}}-{{loop.index}}"></twig:RealisationComponent>

                    {% set lastItem = lastItem + loop.index %}
                    {#
                </div> #}
                {% endfor %}


                {# c'est l√† que la magie op√®re... pr√©voire une petite animation !
                avec le couple balise/id, il y aurait moyen de remplacer dans le DOM l'realisation "loader" une fois les
                nouvelles infos re√ßues.#}
                {% if this.hasMore %}
                {# <div id="page--{{ this.page + 1 }}"> #}
                    {# {% for i in 1..per_page %} #}
                    <div>
                        <realisation class="blog-card" id="realisation--{{ page + 1 }}-{{ lastItem }}" {# ü¶Å - The trigger #} {#
                            {% if loop.first %} #} data-appear-target="loader" data-action="appear->live#action"
                            data-live-action-param="more" {# {% endif %} #}>
                            {# üêπ - Loading bar #}
                            {# Animated progress bar shown during page load #}
                            <span>LOADING</span>
                        </realisation>
                    </div>
                    {# {% endfor %} #}
                    {#
                </div> #}
                {% endif %}
                {% if not this.hasMore %}
                <div>
                    <p>Plus d'autres realisations en stock !!!</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>